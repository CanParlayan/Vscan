import json
import time
import os

class ReportGenerator:
    def __init__(self, given_url):
        # Generate a filename based on the current date and time
        self.filename = f"audit_{time.strftime('%Y%m%d-%H%M')}.json"
        self.url = given_url
        # Create the initial report structure
        self.report_data = {
            "site_url": self.url,
            "timestamp": time.strftime('%Y%m%d-%H%M'),
            "audit_details": []
        }
    def __create_report(self):
        # Open the file in write mode and write the initial information
        with open(self.filename, "w") as f:
            json.dump(self.report_data, f, indent=2)


    def write_to_report(self, details):
        """
        Write to report file
        Args:
            details: Dictionary containing details to be added to the report
        """
        self.report_data["audit_details"].append(details)
        # Ensure the reports directory exists
        os.makedirs('reports', exist_ok=True)
        # Open the file in write mode and write the updated information
        with open(os.path.join('reports', self.filename), "w") as f:
            json.dump(self.report_data, f, indent=2)